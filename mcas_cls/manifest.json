{
    "name": "Microsoft Cloud App Security",
    "id": "mcas_cls",
    "version": "1.0.0",
    "mapping": "Microsoft Cloud App Security Default Mappings",
    "types": [
        "alerts",
        "events"
    ],
    "description": "This plugin is used to fetch unsanctioned data from the Microsoft Cloud App Security platform. This plugin does not support sharing of Indicators to Microsoft CAS.",
    "configuration": [
        {
            "label": "Portal URL",
            "key": "portal_url",
            "type": "text",
            "default": "",
            "mandatory": true,
            "description": "MCAS portal URL, in which the traffic logs are to be ingested. (exclude http(s)://)."
        },
        {
            "label": "API Token",
            "key": "token",
            "type": "password",
            "mandatory": true,
            "description": "MCAS portal's API token for authentication from CLS to MCAS."
        },
        {
            "label": "Data Source",
            "key": "data_source",
            "type": "text",
            "mandatory": true,
            "description": "The data source in which the traffic logs are to be uploaded from CLS."
        },
        {
            "label": "Valid Extensions",
            "key": "valid_extensions",
            "type": "textarea",
            "default": "Full Name,CEF Key Name,Length,Data Type\r\nagentAddress,agt,,IP Address\r\nagentDnsDomain,agentDnsDomain,255,String\r\nagentHostName,ahost,1023,String\r\nagentId,aid,40,String\r\nagentMacAddress,amac,,MAC Address\r\nagentNtDomain,agentNtDomain,255,String\r\nagentReceiptTime,art,,Time Stamp\r\nagentTimeZone,atz,255,String\r\nagentTranslatedAddress,agentTranslatedAddress,,IP Address\r\nagentTranslatedZoneExternalID,agentTranslatedZoneExternalID,200,String\r\nagentTranslatedZoneURI,agentTranslatedZoneURI,2048,String\r\nagentType,at,63,String\r\nagentVersion,av,31,String\r\nagentZoneExternalID,agentZoneExternalID,200,String\r\nagentZoneURI,agentZoneURI,2048,String\r\napplicationProtocol,app,31,String\r\nbaseEventCount,cnt,,Integer\r\nbytesIn,in,,Integer\r\nbytesOut,out,,Integer\r\ncustomerExternalID,customerExternalID,200,String\r\ncustomerURI,customerURI,2048,String\r\ndestinationAddress,dst,1023,String\r\ndestinationDnsDomain,destinationDnsDomain,255,String\r\ndestinationGeoLatitude,dlat,,Floating Point\r\ndestinationGeoLongitude,dlong,,Floating Point\r\ndestinationHostName,dhost,1023,String\r\ndestinationMacAddress,dmac,,MAC Address\r\ndestinationNtDomain,dntdom,255,String\r\ndestinationPort,dpt,65535,Integer\r\ndestinationProcessId,dpid,,Integer\r\ndestinationProcessName,dproc,1023,String\r\ndestinationServiceName,destinationServiceName,1023,String\r\ndestinationTranslatedAddress,destinationTranslatedAddress,,IPv4 Address\r\ndestinationTranslatedPort,destinationTranslatedPort,65535,Integer\r\ndestinationTranslatedZoneExternalID,destinationTranslatedZoneExternalID,200,String\r\ndestinationTranslatedZoneURI,destinationTranslatedZoneURI,2048,String\r\ndestinationUserId,duid,1023,String\r\ndestinationUserName,duser,1023,String\r\ndestinationUserPrivileges,dpriv,1023,String\r\ndestinationZoneExternalID,destinationZoneExternalID,200,String\r\ndestinationZoneURI,destinationZoneURI,2048,String\r\ndeviceAction,act,63,String\r\ndeviceAddress,dvc,,IPv4 Address\r\ndeviceCustomDate1,deviceCustomDate1,,Time Stamp\r\ndeviceCustomDate1Label,deviceCustomDate1Label,1023,String\r\ndeviceCustomDate2,deviceCustomDate2,,Time Stamp\r\ndeviceCustomDate2Label,deviceCustomDate2Label,1023,String\r\ndeviceCustomFloatingPoint1,cfp1,,Floating Point\r\ndeviceCustomFloatingPoint1Label,cfp1Label,1023,String\r\ndeviceCustomFloatingPoint2,cfp2,,Floating Point\r\ndeviceCustomFloatingPoint2Label,cfp2Label,1023,String\r\ndeviceCustomFloatingPoint3,cfp3,,Floating Point\r\ndeviceCustomFloatingPoint3Label,cfp3Label,1023,String\r\ndeviceCustomFloatingPoint4,cfp4,,Floating Point\r\ndeviceCustomFloatingPoint4Label,cfp4Label,1023,String\r\ndeviceCustomIPv6Address1,c6a1,,IPv6 address\r\ndeviceCustomIPv6Address1Label,c6a1Label,1023,String\r\ndeviceCustomIPv6Address3,c6a3,,IPv6 address\r\ndeviceCustomIPv6Address3Label,c6a3Label,1023,String\r\ndeviceCustomIPv6Address4,c6a4,,IPv6 address\r\ndeviceCustomIPv6Address4Label,C6a4Label,1023,String\r\ndeviceCustomNumber1,cn1,,Integer\r\ndeviceCustomNumber1Label,cn1Label,1023,String\r\nDeviceCustomNumber2,cn2,,Integer\r\ndeviceCustomNumber2Label,cn2Label,1023,String\r\ndeviceCustomNumber3,cn3,,Integer\r\ndeviceCustomNumber3Label,cn3Label,1023,String\r\ndeviceCustomString1,cs1,4000,String\r\ndeviceCustomString1Label,cs1Label,1023,String\r\ndeviceCustomString2,cs2,4000,String\r\ndeviceCustomString2Label,cs2Label,1023,String\r\ndeviceCustomString3,cs3,4000,String\r\ndeviceCustomString3Label,cs3Label,1023,String\r\ndeviceCustomString4,cs4,4000,String\r\ndeviceCustomString4Label,cs4Label,1023,String\r\ndeviceCustomString5,cs5,4000,String\r\ndeviceCustomString5Label,cs5Label,1023,String\r\ndeviceCustomString6,cs6,4000,String\r\ndeviceCustomString6Label,cs6Label,1023,String\r\ndeviceDirection,deviceDirection,,Integer\r\ndeviceDnsDomain,deviceDnsDomain,255,String\r\ndeviceEventCategory,cat,1023,String\r\ndeviceExternalId,deviceExternalId,255,String\r\ndeviceFacility,deviceFacility,1023,String\r\ndeviceHostName,dvchost,100,String\r\ndeviceInboundInterface,deviceInboundInterface,128,String\r\ndeviceMacAddress,dvcmac,,MAC Address\r\ndeviceNtDomain,deviceNtDomain,255,String\r\ndeviceOutboundInterface,DeviceOutboundInterface,128,String\r\ndevicePayloadId,DevicePayloadId,128,String\r\ndeviceProcessId,dvcpid,,Integer\r\ndeviceProcessName,deviceProcessName,1023,String\r\ndeviceReceiptTime,rt,,Time Stamp\r\ndeviceTimeZone,dtz,255,String\r\ndeviceTranslatedAddress,deviceTranslatedAddress,,IPv4 Address\r\ndeviceTranslatedZoneExternalID,deviceTranslatedZoneExternalID,200,String\r\ndeviceTranslatedZoneURI,deviceTranslatedZoneURI,2048,String\r\ndeviceZoneExternalID,deviceZoneExternalID,200,String\r\ndeviceZoneURI,deviceZoneURI,2048,String\r\nendTime,end,,String\r\neventId,eventId,,Integer\r\neventOutcome,outcome,63,String\r\nexternalId,externalId,40,String\r\nfileCreateTime,fileCreateTime,,Time Stamp\r\nfileHash,fileHash,255,String\r\nfileId,fileId,1023,String\r\nfileModificationTime,fileModificationTime,,Time Stamp\r\nfilename,fname,1023,String\r\nfilePath,filePath,1023,String\r\nfilePermission,filePermission,1023,String\r\nfileSize,fsize,,Integer\r\nfileType,fileType,1023,String\r\nflexDate1,flexDate1,,Time Stamp\r\nflexDate1Label,flexDate1Label,128,String\r\nflexString1,flexString1,1023,String\r\nflexString2,flexString2,1023,String\r\nflexString2Label,flexString1Label,128,String\r\nflexString2Label,flexString2Label,128,String\r\nmessage,msg,1023,String\r\noldFileCreateTime,oldFileCreateTime,,Time Stamp\r\noldFileHash,oldFileHash,255,String\r\noldFileId,oldFileId,1023,String\r\noldFileModificationTime,oldFileModificationTime,,Time Stamp\r\noldFileName,oldFileName,1023,String\r\noldFilePath,oldFilePath,1023,String\r\noldFilePermission,oldFilePermission,1023,String\r\noldFileSize,oldFileSize,,Integer\r\noldFileType,oldFileType,1023,String\r\nrawEvent,rawEvent,4000,String\r\nReason,reason,1023,String\r\nrequestClientApplication,requestClientApplication,1023,String\r\nrequestContext,requestContext,2048,String\r\nrequestCookies,requestCookies,1023,String\r\nrequestMethod,requestMethod,1023,String\r\nrequestUrl,request,4000,String\r\nsourceAddress,src,1023,String\r\nsourceDnsDomain,sourceDnsDomain,255,String\r\nsourceGeoLatitude,slat,,Floating Point\r\nsourceGeoLongitude,slong,,Floating Point\r\nsourceHostName,shost,1023,String\r\nsourceMacAddress,smac,,MAC Address\r\nsourceNtDomain,sntdom,255,String\r\nsourcePort,spt,65535,Integer\r\nsourceProcessId,spid,,Integer\r\nsourceProcessName,sproc,1023,String\r\nsourceServiceName,sourceServiceName,1023,String\r\nsourceTranslatedAddress,sourceTranslatedAddress,,IPv4 Address\r\nsourceTranslatedPort,sourceTranslatedPort,65535,Integer\r\nsourceTranslatedZoneExternalID,sourceTranslatedZoneExternalID,200,String\r\nsourceTranslatedZoneURI,sourceTranslatedZoneURI,2048,String\r\nsourceUserId,suid,1023,String\r\nsourceUserName,suser,1023,String\r\nsourceUserPrivileges,spriv,1023,String\r\nsourceZoneExternalID,sourceZoneExternalID,200,String\r\nsourceZoneURI,sourceZoneURI,2048,String\r\nstartTime,start,,String\r\ntransportProtocol,proto,31,String\r\ntype,type,,Integer\r\nmd5,md5,1023,String\r\nsha256,sha256,1023,String\r\nobject,object,2048,String\r\ninstanceId,instanceId,1023,String\r\nurl,url,4000,String\r\ndlpIncidentId,dlpIncidentId,,Integer\r\ndlpFile,dlpFile,2048,String\r\ndlpAccountUser,dlpAccountUser,1023,String\r\ndlpRule,dlpRule,1023,String\r\ndlpRuleCount,dlpRuleCount,1023,String\r\ndlpProfile,dlpProfile,1023,String\r\ntimestamp,timestamp,,Integer\r\nccl,ccl,1023,String\r\ncci,cci,1023,String\r\nmanagementId,managementId,1023,String\r\nappcategory,appcategory,1023,String\r\nhostname,hostname,1023,String\r\ndevice,device,1023,String\r\nos,os,1023,String\r\nbrowser,browser,1023,String\r\ndeviceClassification,deviceClassification,1023,String\r\nmimeType,mimeType,1023,String\r\npolicy,policy,1023,String\r\naccessMethod,accessMethod,1023,String\r\nanomalySharedCredentialUser,anomalySharedCredentialUser,1023,String\r\nanomalyEventType,anomalyEventType,1023,String\r\nreferer,referer,4000,String\r\naction,action,1023,String\r\nmwDetectionType,mwDetectionType,1023,String\r\nmwId,mwId,1023,String\r\nmwDetectionName,mwDetectionName,1023,String\r\nmwDetectionEngine,mwDetectionEngine,1023,String\r\nmwScannerResult,mwScannerResult,1023,String\r\nmwType,mwType,1023,String\r\nmwProfile,mwProfile,1023,String\r\ninfSerial,infSerial,1023,String\r\ninfMetricValue,infMetricValue,1023,String\r\ninfAlarmDescription,infAlarmDescription,4000,String\r\ninfAlarmName,infAlarmName,1023,String\r\nclientBytes,clientBytes,1023,String\r\nserverBytes,serverBytes,1023,String\r\npageStarttime,pageStarttime,1023,String\r\npageEndtime,pageEndtime,1023,String\r\npageId,pageId,1023,String\r\npage,page,1023,String\r\nappSessionId,appSessionId,1023,String\r\nauditLogEvent,auditLogEvent,1023,String\r\nauditType,auditType,1023,String\r\nsa_profile_name,saProfileName,1023,String\r\nsa_rule_name,saRuleName,1023,String\r\nsa_account_id,saAccountId,1023,String\r\nsa_asset_tags,saAssetTags,1023,String\r\nsa_rule_remediation,saRuleRemediation,,String\r\nsa_asset_object_id,saAssetObjectId,1023,String\r\nr_app_session_id,rAppSessionId,1023,String\r\nq_original_filename,qOriginalFilename,1023,String\r\nq_app,qApp,1023,String\r\nq_profile,qProfile,1023,String\r\nq_transaction_id,qTransactionId,1023,String\r\nq_file_name,qFileName,1023,String\r\nq_admin,qAdmin,1023,String\r\nq_instance,qInstance,1023,String\r\nms_id,msId,1023,String\r\nms_malicious,msMalicious,1023,String\r\nms_app_session_id,msAppSessionId,1023,String\r\nms_category,msCategory,4000,String\r\nms_page,msPage,4000,String\r\nms_match_field,msMatchField,1023,String\r\nlh_custodian_email,lhCustodianEmail,1023,String\r\nlh_custodian_name,lhCustodianName,1023,String\r\nlh_dest_app,lhDestApp,1023,String\r\nlh_shared,lhShared,1023,String\r\nlh_instance,lhInstance,1023,String\r\nlh_file_path,lhFilePath,4000,String\r\nlh_dest_instance,lhDestInstance,1023,String\r\nlh_original_filename,lhOriginalFilename,1023,String\r\nlh_profile_name,lhProfileName,1023,String\r\nlh_modified,lhModified,1023,String\r\ncc_breach_media_references,ccBreachMediaReferences,4000,String\r\ncc_email_source,ccEmailSource,1023,String\r\ncc_breach_score,ccBreachScore,1023,String\r\ncc_breach_date,ccBreachDate,,Integer\r\ncc_matched_username,ccMatchedUsername,1023,String\r\nsrc_geoip_src,srcGeoipSrc,,Integer\r\ncount,count,,Integer\r\nsrc_country,srcCountry,1023,String\r\nur_normalized,urNormalized,1023,String\r\nnumbytes,numbytes,,Integer\r\nuserip,userip,,IPv4 Address\r\ntraffic_type,trafficType,1023,String\r\ncategory,category,,String\r\naccess_method,accessMethod,1023,String\r\nsrc_location,srcLocation,1023,String\r\nsrc_zipcode,srcZipcode,1023,String\r\nos_version,osVersion,1023,String\r\ntunnel_id,tunnelId,1023,String\r\norganization_unit,organizationUnit,1023,String\r\nsrc_region,srcRegion,1023,String\r\nclient_packets,clientPackets,,Integer\r\nnetwork_session_id,networkSessionId,,Integer\r\nprotocol,protocol,1023,String\r\nserver_packets,serverPackets,,Integer\r\nsession_duration,sessionDuration,1023,String\r\ntunnel_type,tunnelType,1023,String\r\ntunnel_up_time,tunnelUpTime,1023,String\r\napplicationType,applicationType,1023,String\r\nevent_type,event_type,,String\r\npolicy_name,policy_name,,String\r\npolicy_actions,policy_actions,,String\r\nuba_inst1,uba_inst1,,String\r\nuba_inst2,uba_inst2,,String\r\nuba_ap1,uba_ap1,,String\r\nuba_ap2,uba_ap2,,String\r\nmd5_list,md5_list,,String\r\nNetskopeSecurityCloudFileMD5List,NetskopeSecurityCloudFileMD5List,,String\r\nNetskopeSecurityCloudEventType,NetskopeSecurityCloudEventType,,String\r\nNetskopeSecurityCloudPolicyName,NetskopeSecurityCloudPolicyName,,String\r\nNetskopeSecurityCloudPolicyActions,NetskopeSecurityCloudPolicyActions,,String\r\nNetskopeSecurityCloudUBAInstance1,NetskopeSecurityCloudUBAInstance1,,String\r\nNetskopeSecurityCloudUBAInstance2,NetskopeSecurityCloudUBAInstance2,,String\r\nNetskopeSecurityCloudUBAApp1,NetskopeSecurityCloudUBAApp1,,String\r\nNetskopeSecurityCloudUBAApp2,NetskopeSecurityCloudUBAApp2,,String\r\nNetskopeSecurityCloudDeviceID,NetskopeSecurityCloudDeviceID,255,String\r\nNetskopeSecurityCloudCloudConfidenceLevel,NetskopeSecurityCloudCloudConfidenceLevel,1023,String\r\nNetskopeSecurityCloudCloudConfidenceIndex,NetskopeSecurityCloudCloudConfidenceIndex,1023,String\r\nNetskopeSecurityCloudManagementID,NetskopeSecurityCloudManagementID,1023,String\r\nNetskopeSecurityCloudAnomalySharedUser,NetskopeSecurityCloudAnomalySharedUser,1023,String\r\nNetskopeSecurityCloudAppCategory,NetskopeSecurityCloudAppCategory,1023,String\r\nNetskopeSecurityCloudDevice,NetskopeSecurityCloudDevice,1023,String\r\nNetskopeSecurityCloudDeviceOS,NetskopeSecurityCloudDeviceOS,1023,String\r\nNetskopeSecurityCloudDeviceBrowser,NetskopeSecurityCloudDeviceBrowser,1023,String\r\nNetskopeSecurityCloudDeviceClassification,NetskopeSecurityCloudDeviceClassification,1023,String\r\nNetskopeSecurityCloudFileMD5,NetskopeSecurityCloudFileMD5,1023,String\r\nNetskopeSecurityCloudFileSHA256,NetskopeSecurityCloudFileSHA256,1023,String\r\nNetskopeSecurityCloudInstanceID,NetskopeSecurityCloudInstanceID,1023,String\r\nNetskopeSecurityCloudDLPIncidentID,NetskopeSecurityCloudDLPIncidentID,,Integer\r\nNetskopeSecurityCloudAccountUser,NetskopeSecurityCloudAccountUser,1023,String\r\nNetskopeSecurityCloudRule,NetskopeSecurityCloudRule,1023,String\r\nNetskopeSecurityCloudRuleCount,NetskopeSecurityCloudRuleCount,1023,String\r\nNetskopeSecurityCloudProfile,NetskopeSecurityCloudProfile,1023,String\r\nNetskopeSecurityCloudAction,NetskopeSecurityCloudAction,1023,String\r\nNetskopeSecurityCloudDetectionType,NetskopeSecurityCloudDetectionType,1023,String\r\nNetskopeSecurityCloudMalwareID,NetskopeSecurityCloudMalwareID,1023,String\r\nNetskopeSecurityCloudDetectionName,NetskopeSecurityCloudDetectionName,1023,String\r\nNetskopeScurityCloudDetectionEngine,NetskopeScurityCloudDetectionEngine,1023,String\r\nNetskopeSecurityCloudDetectionVerdict,NetskopeSecurityCloudDetectionVerdict,1023,String\r\nNetskopeSecurityCloudMalwareType,NetskopeSecurityCloudMalwareType,1023,String\r\nNetskopeSecurityCloudBreachReference,NetskopeSecurityCloudBreachReference,4000,String\r\nNetskopeSecurityCloudEmailSource,NetskopeSecurityCloudEmailSource,1023,String\r\nNetskopeSecurityCloudBreachScore,NetskopeSecurityCloudBreachScore,1023,String\r\nNetskopeSecurityCloudBreachDate,NetskopeSecurityCloudBreachDate,,Integer\r\nNetskopeSecurityCloudBreachMatchedUsername,NetskopeSecurityCloudBreachMatchedUsername,1023,String\r\nNetskpeSecurityCloudDLPProfile,NetskpeSecurityCloudDLPProfile,1023,String\r\nNetskopeSecurityCloudLHCustodianEmail,NetskopeSecurityCloudLHCustodianEmail,1023,String\r\nNetskopeSecurityCloudLHCustodianName,NetskopeSecurityCloudLHCustodianName,1023,String\r\nNetskopeSecurityCloudLHDestinationApp,NetskopeSecurityCloudLHDestinationApp,1023,String\r\nNetskopeSecurityCloudLHShared,NetskopeSecurityCloudLHShared,1023,String\r\nNetskopeSecurityCloudLHInstance,NetskopeSecurityCloudLHInstance,1023,String\r\nNetskopeSecurityCloudLHFilePath,NetskopeSecurityCloudLHFilePath,4000,String\r\nNetskopeSecurityCloudDestinationInstance,NetskopeSecurityCloudDestinationInstance,1023,String\r\nNetskopeSecurityCloudLHProfileName,NetskopeSecurityCloudLHProfileName,1023,String\r\nNetskopeSecurityCloudLHModified,NetskopeSecurityCloudLHModified,1023,String\r\nNetskopeSecurityCloudThreatMatch,NetskopeSecurityCloudThreatMatch,1023,String\r\nNetskopeSecurityCloudMalsiteID,NetskopeSecurityCloudMalsiteID,1023,String\r\nNetskopeSecurityCloudMalsiteMalicious,NetskopeSecurityCloudMalsiteMalicious,1023,String\r\nNetskopeSecurityCloudAppSessionID,NetskopeSecurityCloudAppSessionID,1023,String\r\nNetskopeSecurityCloudMalsiteCategory,NetskopeSecurityCloudMalsiteCategory,4000,String\r\nNetskopeSecurityCloudOriginalFname,NetskopeSecurityCloudOriginalFname,1023,String\r\nNetskopeSecurityCloudQuaratineApp,NetskopeSecurityCloudQuaratineApp,1023,String\r\nNetskopeSecurityCloudTransactionID,NetskopeSecurityCloudTransactionID,1023,String\r\nNetskopeSecurityCloudQuarantineAdmin,NetskopeSecurityCloudQuarantineAdmin,1023,String\r\nNetskopeSecurityCloudQuaratineInstance,NetskopeSecurityCloudQuaratineInstance,1023,String\r\nNetskopeSecurityCloudIaaSObject,NetskopeSecurityCloudIaaSObject,2048,String\r\nNetskopeSecurityCloudAccountIaaSAccountID,NetskopeSecurityCloudAccountIaaSAccountID,1023,String\r\nNetskopeSecurityCloudAssetTags,NetskopeSecurityCloudAssetTags,1023,String\r\nNetskopeSecurityCloudRemediation,NetskopeSecurityCloudRemediation,,String\r\nNetskopeSecurityCloudIaaSObjectID,NetskopeSecurityCloudIaaSObjectID,1023,String\r\nNetskopeSecurityCloudPageStarttime,NetskopeSecurityCloudPageStarttime,1023,String\r\nNetskopeSecurityCloudPageEndtime,NetskopeSecurityCloudPageEndtime,1023,String\r\nNetskopeSecurityCloudPageID,NetskopeSecurityCloudPageID,1023,String\r\nNetskopeSecurityCloudPage,NetskopeSecurityCloudPage,1023,String\r\nNetskopeSecurityCloudAuditEvent,NetskopeSecurityCloudAuditEvent,1023,String\r\nNetskopeSecurityCloudAuditType,NetskopeSecurityCloudAuditType,1023,String\r\nNetskopeSecurityCloudClientPackets,NetskopeSecurityCloudClientPackets,,Integer\r\nNetskopeSecurityCloudSessionID,NetskopeSecurityCloudSessionID,,Integer\r\nNetskopeSecurityCloudPolicy,NetskopeSecurityCloudPolicy,1023,String\r\nNetskopeSecurityCloudTrafficType,NetskopeSecurityCloudTrafficType,1023,String\r\nNetskopeSecurityCloudOSVersion,NetskopeSecurityCloudOSVersion,1023,String\r\nNetskopeSecurityCloudServerPackets,NetskopeSecurityCloudServerPackets,,Integer\r\nNetskopeSecurityCloudTunnelID,NetskopeSecurityCloudTunnelID,1023,String\r\nNetskopeSecurityCloudTunnelType,NetskopeSecurityCloudTunnelType,1023,String\r\nNetskopeSecurityCloudTunnelUpTime,NetskopeSecurityCloudTunnelUpTime,1023,String\r\nNetskopeSecurityCloudApplicationType,NetskopeSecurityCloudApplicationType,1023,String",
            "mandatory": true,
            "description": "valid extensions in CSV format."
        }
    ]
}